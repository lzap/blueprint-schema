{
  "valid": false,
  "evaluationPath": "",
  "schemaLocation": "",
  "instanceLocation": "",
  "annotations": {
    "description": "Image Builder new blueprint schema.\n\nTHIS IS WORK IN PROGRESS"
  },
  "errors": {
    "properties": "Property 'openscap' does not match the schema"
  },
  "details": [
    {
      "valid": true,
      "evaluationPath": "/properties/name",
      "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/properties/name",
      "instanceLocation": "/name",
      "annotations": {
        "description": "The name attribute is a string that contains the name of the blueprint. It can contain spaces,\nbut they may be converted to dash characters during build. It should be short and descriptive."
      }
    },
    {
      "valid": false,
      "evaluationPath": "/properties/openscap",
      "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/properties/openscap",
      "instanceLocation": "/openscap",
      "errors": {
        "oneOf": "Value does not match the oneOf schema"
      },
      "details": [
        {
          "valid": false,
          "evaluationPath": "/oneOf/0",
          "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/oneOf/0",
          "instanceLocation": "",
          "annotations": {
            "description": "From RHEL 8.7 \u0026 RHEL 9.1 support has been added for OpenSCAP build-time remediation"
          },
          "errors": {
            "$ref": "Value does not match the reference schema"
          },
          "details": [
            {
              "valid": false,
              "evaluationPath": "",
              "schemaLocation": "",
              "instanceLocation": "",
              "errors": {
                "properties": "Property 'tailoring' does not match the schema"
              },
              "details": [
                {
                  "valid": true,
                  "evaluationPath": "/properties/datastream",
                  "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/properties/datastream",
                  "instanceLocation": "/datastream",
                  "annotations": {
                    "description": "Datastream to use for the scan. The datastream is the path to the SCAP datastream file to use for the scan.\nIf the datastream parameter is not provided, a sensible default based on the selected distro will be chosen."
                  }
                },
                {
                  "valid": true,
                  "evaluationPath": "/properties/profile_id",
                  "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/properties/profile_id",
                  "instanceLocation": "/profile_id",
                  "annotations": {
                    "description": "The desired security profile ID."
                  }
                },
                {
                  "valid": false,
                  "evaluationPath": "/properties/tailoring",
                  "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/properties/tailoring",
                  "instanceLocation": "/tailoring",
                  "errors": {
                    "oneOf": "Value does not match the oneOf schema"
                  },
                  "details": [
                    {
                      "valid": false,
                      "evaluationPath": "/oneOf/0",
                      "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/oneOf/0",
                      "instanceLocation": "",
                      "annotations": {
                        "description": "An optional OpenSCAP tailoring information. Can be done via profile selection or tailoring JSON file.\n\nIn case of profile selection, a tailoring file with a new tailoring profile ID is created and saved to the image.\nThe new tailoring profile ID is created by appending the _osbuild_tailoring suffix to the base profile.\nFor example, given tailoring options for the cis profile, tailoring profile\nxccdf_org.ssgproject.content_profile_cis_osbuild_tailoring will be created. The default namespace of the rules\nis org.ssgproject.content, so the prefix may be omitted for rules under this namespace, i.e.\norg.ssgproject.content_grub2_password and grub2_password are functionally equivalent.\nThe generated tailoring file is saved to the image as /usr/share/xml/osbuild-oscap-tailoring/tailoring.xml or,\nfor newer releases, in the /oscap_data directory, this is the location used for other OpenSCAP related artifacts.\n\nIt is also possible to use JSON tailoring. In that case, custom JSON file must be provided using the blueprint and\nused in json_filepath field alongside with json_profile_id field. The generated XML tailoring file is saved to the\nimage as /oscap_data/tailoring.xml."
                      },
                      "errors": {
                        "$ref": "Value does not match the reference schema"
                      },
                      "details": [
                        {
                          "valid": false,
                          "evaluationPath": "",
                          "schemaLocation": "",
                          "instanceLocation": "",
                          "errors": {
                            "oneOf": "Value should match exactly one schema but matches multiple at indexes 0, 1"
                          },
                          "details": [
                            {
                              "valid": true,
                              "evaluationPath": "/oneOf/0",
                              "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/oneOf/0",
                              "instanceLocation": "",
                              "details": [
                                {
                                  "valid": false,
                                  "evaluationPath": "/anyOf/0",
                                  "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/anyOf/0",
                                  "instanceLocation": "",
                                  "annotations": {
                                    "title": "tailoring_both"
                                  },
                                  "errors": {
                                    "required": "Required property 'unselected' is missing"
                                  }
                                },
                                {
                                  "valid": true,
                                  "evaluationPath": "/anyOf/1",
                                  "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/anyOf/1",
                                  "instanceLocation": "",
                                  "annotations": {
                                    "title": "tailoring_selected"
                                  }
                                },
                                {
                                  "valid": false,
                                  "evaluationPath": "/anyOf/2",
                                  "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/anyOf/2",
                                  "instanceLocation": "",
                                  "annotations": {
                                    "title": "tailoring_unselected"
                                  },
                                  "errors": {
                                    "required": "Required property 'unselected' is missing"
                                  }
                                }
                              ]
                            },
                            {
                              "valid": true,
                              "evaluationPath": "/oneOf/1",
                              "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/oneOf/1",
                              "instanceLocation": "",
                              "details": [
                                {
                                  "valid": true,
                                  "evaluationPath": "/oneOf/0",
                                  "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/oneOf/0",
                                  "instanceLocation": "",
                                  "annotations": {
                                    "title": "tailoring_json"
                                  }
                                }
                              ]
                            },
                            {
                              "valid": true,
                              "evaluationPath": "/properties/json_filepath",
                              "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/properties/json_filepath",
                              "instanceLocation": "/json_filepath",
                              "annotations": {
                                "description": "JSON filepath, must be used with json_profile_id and cannot be used with selected and unselected fields."
                              }
                            },
                            {
                              "valid": true,
                              "evaluationPath": "/properties/json_profile_id",
                              "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/properties/json_profile_id",
                              "instanceLocation": "/json_profile_id",
                              "annotations": {
                                "description": "JSON profile ID, must be used with json_filepath and cannot be used with selected and unselected fields."
                              }
                            },
                            {
                              "valid": true,
                              "evaluationPath": "/properties/selected",
                              "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/properties/selected",
                              "instanceLocation": "/selected",
                              "annotations": {
                                "description": "Selected rules, cannot be used with json_profile_id and json_filepath."
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "valid": false,
                      "evaluationPath": "/oneOf/1",
                      "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/oneOf/1",
                      "instanceLocation": "",
                      "errors": {
                        "type": "Value is object but should be null"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "valid": false,
          "evaluationPath": "/oneOf/1",
          "schemaLocation": "https://github.com/osbuild/blueprint-schema/blueprint#/oneOf/1",
          "instanceLocation": "",
          "errors": {
            "type": "Value is object but should be null"
          }
        }
      ]
    }
  ]
}